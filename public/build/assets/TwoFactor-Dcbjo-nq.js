import{r as ae,s as se,q as oe,c as re,d as ne,f as le,_ as ie,a as ce,g as de,h as ue}from"./Layout.vue_vue_type_script_setup_true_lang-Bsx20ZPj.js";import{c as L,b as fe,_ as w}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-sZz9Mk1i.js";import{d as S,a as c,A as z,u as e,r as O,o as s,c as q,g as m,w as o,e as t,f,t as $,b as a,F as b,x as A,v as x,ah as W,E as pe,j as ve,s as me,i as V,m as P,G as X,ai as ye,aj as _e,C as he,I as be,h as ge,n as we,k as xe}from"./app-DdsqN3T_.js";import{C as ke,_ as Ce}from"./CardDescription.vue_vue_type_script_setup_true_lang-CrCTIDLf.js";import{_ as $e,a as Se}from"./CardContent.vue_vue_type_script_setup_true_lang-_rr4vPww.js";import{a as Fe,_ as Me}from"./CardTitle.vue_vue_type_script_setup_true_lang-7Si3YFXn.js";import{c as k}from"./createLucideIcon-DaCMYqYG.js";import{_ as Ae}from"./InputError.vue_vue_type_script_setup_true_lang-UwEG-xjI.js";import{_ as U}from"./Spinner.vue_vue_type_script_setup_true_lang-Da55Ck-g.js";import{_ as Te,b as Re,c as Ee,a as je}from"./DialogTitle.vue_vue_type_script_setup_true_lang-D61x6NXH.js";import{_ as qe}from"./DialogDescription.vue_vue_type_script_setup_true_lang-B2pM33Lx.js";import{_ as Ve,a as ze,b as Ie}from"./PinInputSlot.vue_vue_type_script_setup_true_lang-BB-IdAih.js";import{s as De}from"./useForwardExpose-D2gwfd_t.js";import{C as Be}from"./check-DLbwmX5r.js";import{_ as G}from"./index-S0Kw84i7.js";import{_ as Le}from"./AppLayout.vue_vue_type_script_setup_true_lang-BC9ZMQcH.js";import"./index-DPfDGp1o.js";import"./index-BSOEGDrY.js";import"./VisuallyHidden-BADxonjd.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./VisuallyHiddenInput-C2tb8LRA.js";import"./RovingFocusGroup-CkKkzSAL.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=k("CopyIcon",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=k("EyeOffIcon",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=k("EyeIcon",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=k("LockKeyholeIcon",[["circle",{cx:"12",cy:"16",r:"1",key:"1au0dj"}],["rect",{x:"3",y:"10",width:"18",height:"12",rx:"2",key:"6s8ecr"}],["path",{d:"M7 10V7a5 5 0 0 1 10 0v3",key:"1pqi11"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=k("RefreshCwIcon",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=k("ScanLineIcon",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=k("ShieldBanIcon",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m4.243 5.21 14.39 12.472",key:"1c9a7c"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=k("ShieldCheckIcon",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Ge=S({__name:"Alert",props:{class:{},variant:{}},setup(l){const n=l;return(i,p)=>(s(),c("div",{"data-slot":"alert",class:z(e(L)(e(Xe)({variant:l.variant}),n.class)),role:"alert"},[O(i.$slots,"default")],2))}}),Je=S({__name:"AlertDescription",props:{class:{}},setup(l){const n=l;return(i,p)=>(s(),c("div",{"data-slot":"alert-description",class:z(e(L)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",n.class))},[O(i.$slots,"default")],2))}}),We=S({__name:"AlertTitle",props:{class:{}},setup(l){const n=l;return(i,p)=>(s(),c("div",{"data-slot":"alert-title",class:z(e(L)("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",n.class))},[O(i.$slots,"default")],2))}}),Xe=fe("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}}),Ye={class:"list-inside list-disc text-sm"},Y=S({__name:"AlertError",props:{errors:{},title:{default:"Something went wrong."}},setup(l){const n=l,i=q(()=>Array.from(new Set(n.errors)));return(p,u)=>(s(),m(e(Ge),{variant:"destructive"},{default:o(()=>[t(e(ke),{class:"size-4"}),t(e(We),null,{default:o(()=>[f($(l.title),1)]),_:1}),t(e(Je),null,{default:o(()=>[a("ul",Ye,[(s(!0),c(b,null,A(i.value,(y,r)=>(s(),c("li",{key:r},$(y),1))),128))])]),_:1})]),_:1}))}}),B=async l=>{const n=await fetch(l,{headers:{Accept:"application/json"}});if(!n.ok)throw new Error(`Failed to fetch: ${n.status}`);return n.json()},R=x([]),F=x(null),M=x(null),j=x([]),Ze=q(()=>M.value!==null&&F.value!==null),N=()=>{const l=async()=>{try{const{svg:v}=await B(oe.url());M.value=v}catch{R.value.push("Failed to fetch QR code"),M.value=null}},n=async()=>{try{const{secretKey:v}=await B(se.url());F.value=v}catch{R.value.push("Failed to fetch a setup key"),F.value=null}},i=()=>{F.value=null,M.value=null,p()},p=()=>{R.value=[]};return{qrCodeSvg:M,manualSetupKey:F,recoveryCodesList:j,errors:R,hasSetupData:Ze,clearSetupData:i,clearErrors:p,clearTwoFactorAuthData:()=>{i(),p(),j.value=[]},fetchQrCode:l,fetchSetupKey:n,fetchSetupData:async()=>{try{p(),await Promise.all([l(),n()])}catch{M.value=null,F.value=null}},fetchRecoveryCodes:async()=>{try{p(),j.value=await B(ae.url())}catch{R.value.push("Failed to fetch recovery codes"),j.value=[]}}}},et={class:"flex flex-col gap-3 select-none sm:flex-row sm:items-center sm:justify-between"},tt={key:0,class:"mt-6"},at={key:1,class:"mt-3 space-y-3"},st={key:0,class:"space-y-2"},ot=S({__name:"TwoFactorRecoveryCodes",setup(l){const{recoveryCodesList:n,fetchRecoveryCodes:i,errors:p}=N(),u=x(!1),y=W("recoveryCodeSectionRef"),r=async()=>{!u.value&&!n.value.length&&await i(),u.value=!u.value,u.value&&(await X(),y.value?.scrollIntoView({behavior:"smooth"}))};return pe(async()=>{n.value.length||await i()}),(v,_)=>(s(),m(e($e),{class:"w-full"},{default:o(()=>[t(e(Me),null,{default:o(()=>[t(e(Fe),{class:"flex gap-3"},{default:o(()=>[t(e(Ke),{class:"size-4"}),_[0]||(_[0]=f("2FA Recovery Codes ",-1))]),_:1}),t(e(Ce),null,{default:o(()=>[..._[1]||(_[1]=[f(" Recovery codes let you regain access if you lose your 2FA device. Store them in a secure password manager. ",-1)])]),_:1})]),_:1}),t(e(Se),null,{default:o(()=>[a("div",et,[t(e(w),{onClick:r,class:"w-fit"},{default:o(()=>[(s(),m(me(u.value?e(Pe):e(Ne)),{class:"size-4"})),f(" "+$(u.value?"Hide":"View")+" Recovery Codes ",1)]),_:1}),u.value&&e(n).length?(s(),m(e(V),P({key:0},e(re).form(),{method:"post",options:{preserveScroll:!0},onSuccess:e(i)}),{default:o(({processing:g})=>[t(e(w),{variant:"secondary",type:"submit",disabled:g},{default:o(()=>[t(e(He)),_[2]||(_[2]=f(" Regenerate Codes ",-1))]),_:1},8,["disabled"])]),_:1},16,["onSuccess"])):ve("",!0)]),a("div",{class:z(["relative overflow-hidden transition-all duration-300",u.value?"h-auto opacity-100":"h-0 opacity-0"])},[e(p)?.length?(s(),c("div",tt,[t(Y,{errors:e(p)},null,8,["errors"])])):(s(),c("div",at,[a("div",{ref_key:"recoveryCodeSectionRef",ref:y,class:"grid gap-1 rounded-lg bg-muted p-4 font-mono text-sm"},[e(n).length?(s(!0),c(b,{key:1},A(e(n),(g,C)=>(s(),c("div",{key:C},$(g),1))),128)):(s(),c("div",st,[(s(),c(b,null,A(8,g=>a("div",{key:g,class:"h-4 animate-pulse rounded bg-muted-foreground/20"})),64))]))],512),_[3]||(_[3]=a("p",{class:"text-xs text-muted-foreground select-none"},[f(" Each recovery code can be used once to access your account and will be removed after use. If you need more, click "),a("span",{class:"font-bold"},"Regenerate Codes"),f(" above. ")],-1))]))],2)]),_:1})]),_:1}))}}),rt={class:"mb-3 w-auto rounded-full border border-border bg-card p-0.5 shadow-sm"},nt={class:"relative overflow-hidden rounded-full border border-border bg-muted p-2.5"},lt={class:"absolute inset-0 grid grid-cols-5 opacity-50"},it={class:"absolute inset-0 grid grid-rows-5 opacity-50"},ct={class:"relative flex w-auto flex-col items-center justify-center space-y-5"},dt={class:"relative mx-auto flex max-w-md items-center overflow-hidden"},ut={class:"relative mx-auto aspect-square w-64 overflow-hidden rounded-lg border border-border"},ft={key:0,class:"absolute inset-0 z-10 flex aspect-square h-auto w-full animate-pulse items-center justify-center bg-background"},pt={key:1,class:"relative z-10 overflow-hidden border p-5"},vt=["innerHTML"],mt={class:"flex w-full items-center space-x-5"},yt={class:"flex w-full items-center justify-center space-x-2"},_t={class:"flex w-full items-stretch overflow-hidden rounded-xl border border-border"},ht={key:0,class:"flex h-full w-full items-center justify-center bg-muted p-3"},bt=["value"],gt=["value"],wt={class:"flex w-full flex-col items-center justify-center space-y-3 py-2"},xt={class:"flex w-full items-center space-x-5"},kt=S({__name:"TwoFactorSetupModal",props:ye({requiresConfirmation:{type:Boolean},twoFactorEnabled:{type:Boolean}},{isOpen:{type:Boolean},isOpenModifiers:{}}),emits:["update:isOpen"],setup(l){const n=l,i=_e(l,"isOpen"),{copy:p,copied:u}=De(),{qrCodeSvg:y,manualSetupKey:r,clearSetupData:v,fetchSetupData:_,errors:g}=N(),C=x(!1),T=x([]),K=q(()=>T.value.join("")),H=W("pinInputContainerRef"),I=q(()=>n.twoFactorEnabled?{title:"Two-Factor Authentication Enabled",description:"Two-factor authentication is now enabled. Scan the QR code or enter the setup key in your authenticator app.",buttonText:"Close"}:C.value?{title:"Verify Authentication Code",description:"Enter the 6-digit code from your authenticator app",buttonText:"Continue"}:{title:"Enable Two-Factor Authentication",description:"To finish enabling two-factor authentication, scan the QR code or enter the setup key in your authenticator app",buttonText:"Continue"}),Z=()=>{if(n.requiresConfirmation){C.value=!0,X(()=>{H.value?.querySelector("input")?.focus()});return}v(),i.value=!1},ee=()=>{n.twoFactorEnabled&&v(),C.value=!1,T.value=[]};return he(()=>i.value,async Q=>{if(!Q){ee();return}y.value||await _()}),(Q,d)=>(s(),m(e(Te),{open:i.value,"onUpdate:open":d[5]||(d[5]=h=>i.value=h)},{default:o(()=>[t(e(je),{class:"sm:max-w-md"},{default:o(()=>[t(e(Re),{class:"flex items-center justify-center"},{default:o(()=>[a("div",rt,[a("div",nt,[a("div",lt,[(s(),c(b,null,A(5,h=>a("div",{key:`col-${h}`,class:"border-r border-border last:border-r-0"})),64))]),a("div",it,[(s(),c(b,null,A(5,h=>a("div",{key:`row-${h}`,class:"border-b border-border last:border-b-0"})),64))]),t(e(Qe),{class:"relative z-20 size-6 text-foreground"})])]),t(e(Ee),null,{default:o(()=>[f($(I.value.title),1)]),_:1}),t(e(qe),{class:"text-center"},{default:o(()=>[f($(I.value.description),1)]),_:1})]),_:1}),a("div",ct,[C.value?(s(),m(e(V),P({key:1},e(ne).form(),{"reset-on-error":"",onFinish:d[3]||(d[3]=h=>T.value=[]),onSuccess:d[4]||(d[4]=h=>i.value=!1)}),{default:o(({errors:h,processing:D})=>[a("input",{type:"hidden",name:"code",value:K.value},null,8,gt),a("div",{ref_key:"pinInputContainerRef",ref:H,class:"relative w-full space-y-3"},[a("div",wt,[t(e(Ve),{id:"otp",placeholder:"○",modelValue:T.value,"onUpdate:modelValue":d[1]||(d[1]=E=>T.value=E),type:"number",otp:""},{default:o(()=>[t(e(ze),null,{default:o(()=>[(s(),c(b,null,A(6,(E,te)=>t(e(Ie),{autofocus:"",key:E,index:te,disabled:D},null,8,["index","disabled"])),64))]),_:2},1024)]),_:2},1032,["modelValue"]),t(Ae,{message:h?.confirmTwoFactorAuthentication?.code},null,8,["message"])]),a("div",xt,[t(e(w),{type:"button",variant:"outline",class:"w-auto flex-1",onClick:d[2]||(d[2]=E=>C.value=!1),disabled:D},{default:o(()=>[...d[7]||(d[7]=[f(" Back ",-1)])]),_:1},8,["disabled"]),t(e(w),{type:"submit",class:"w-auto flex-1",disabled:D||K.value.length<6},{default:o(()=>[...d[8]||(d[8]=[f(" Confirm ",-1)])]),_:1},8,["disabled"])])],512)]),_:1},16)):(s(),c(b,{key:0},[e(g)?.length?(s(),m(Y,{key:0,errors:e(g)},null,8,["errors"])):(s(),c(b,{key:1},[a("div",dt,[a("div",ut,[e(y)?(s(),c("div",pt,[a("div",{innerHTML:e(y),class:"flex aspect-square size-full items-center justify-center"},null,8,vt)])):(s(),c("div",ft,[t(e(U),{class:"size-6"})]))])]),a("div",mt,[t(e(w),{class:"w-full",onClick:Z},{default:o(()=>[f($(I.value.buttonText),1)]),_:1})]),d[6]||(d[6]=a("div",{class:"relative flex w-full items-center justify-center"},[a("div",{class:"absolute inset-0 top-1/2 h-px w-full bg-border"}),a("span",{class:"relative bg-card px-2 py-1"},"or, enter the code manually")],-1)),a("div",yt,[a("div",_t,[e(r)?(s(),c(b,{key:1},[a("input",{type:"text",readonly:"",value:e(r),class:"h-full w-full bg-background p-3 text-foreground"},null,8,bt),a("button",{onClick:d[0]||(d[0]=h=>e(p)(e(r)||"")),class:"relative block h-auto border-l border-border px-3 hover:bg-muted"},[e(u)?(s(),m(e(Be),{key:0,class:"w-4 text-green-500"})):(s(),m(e(Oe),{key:1,class:"w-4"}))])],64)):(s(),c("div",ht,[t(e(U))]))])])],64))],64))])]),_:1})]),_:1},8,["open"]))}}),Ct={class:"space-y-6"},$t={key:0,class:"flex flex-col items-start justify-start space-y-4"},St={key:1,class:"flex flex-col items-start justify-start space-y-4"},Ft={class:"relative inline"},Wt=S({__name:"TwoFactor",props:{requiresConfirmation:{type:Boolean,default:!1},twoFactorEnabled:{type:Boolean,default:!1}},setup(l){const n=[{title:"Autenticación en dos pasos",href:le.url()}],{hasSetupData:i,clearTwoFactorAuthData:p}=N(),u=x(!1);return be(()=>{p()}),(y,r)=>(s(),m(Le,{breadcrumbs:n},{default:o(()=>[t(e(ge),{title:"Autenticación en dos pasos"}),t(ie,null,{default:o(()=>[a("div",Ct,[t(ce,{title:"Autenticación en dos pasos",description:"Administra la configuración de tu autenticación en dos pasos"}),l.twoFactorEnabled?(s(),c("div",St,[t(e(G),{variant:"default"},{default:o(()=>[...r[7]||(r[7]=[f("Activado",-1)])]),_:1}),r[9]||(r[9]=a("p",{class:"text-muted-foreground"}," Con la autenticación en dos pasos activada, se te pedirá un PIN seguro y aleatorio al iniciar sesión, que podrás obtener desde la aplicación compatible con TOTP en tu teléfono. ",-1)),t(ot),a("div",Ft,[t(e(V),we(xe(e(ue).form())),{default:o(({processing:v})=>[t(e(w),{variant:"destructive",type:"submit",disabled:v},{default:o(()=>[t(e(Ue)),r[8]||(r[8]=f(" Desactivar 2FA ",-1))]),_:1},8,["disabled"])]),_:1},16)])])):(s(),c("div",$t,[t(e(G),{variant:"destructive"},{default:o(()=>[...r[3]||(r[3]=[f("Desactivado",-1)])]),_:1}),r[6]||(r[6]=a("p",{class:"text-muted-foreground"}," Cuando actives la autenticación en dos pasos, se te pedirá un PIN seguro al iniciar sesión. Este PIN se puede obtener desde una aplicación compatible con TOTP en tu teléfono. ",-1)),a("div",null,[e(i)?(s(),m(e(w),{key:0,onClick:r[0]||(r[0]=v=>u.value=!0)},{default:o(()=>[t(e(J)),r[4]||(r[4]=f("Continuar configuración ",-1))]),_:1})):(s(),m(e(V),P({key:1},e(de).form(),{onSuccess:r[1]||(r[1]=v=>u.value=!0)}),{default:o(({processing:v})=>[t(e(w),{type:"submit",disabled:v},{default:o(()=>[t(e(J)),r[5]||(r[5]=f("Activar 2FA",-1))]),_:1},8,["disabled"])]),_:1},16))])])),t(kt,{isOpen:u.value,"onUpdate:isOpen":r[2]||(r[2]=v=>u.value=v),requiresConfirmation:l.requiresConfirmation,twoFactorEnabled:l.twoFactorEnabled},null,8,["isOpen","requiresConfirmation","twoFactorEnabled"])])]),_:1})]),_:1}))}});export{Wt as default};
